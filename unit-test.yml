parameters:
- name: BuildTaskFramework
  type: string

steps:
- task: DotNetCoreCLI@2
  displayName: Build all except integration tests - ${{ parameters.BuildTaskFramework }}
  inputs:
    command: build
    projects: |
      **/*.csproj
      !**/FileShareClientIntegrationTests.csproj
    arguments: '--framework ${{ parameters.BuildTaskFramework }} --configuration $(BuildConfiguration) --output $(Build.ArtifactStagingDirectory)\${{ parameters.BuildTaskFramework }} --no-restore'

- task: DotNetCoreCLI@2
  displayName: Run unit tests - ${{ parameters.BuildTaskFramework }}
  inputs:
    command: test
    projects: |
      **/*Tests.csproj
      !**/FileShareClientIntegrationTests.csproj
    arguments: '--configuration $(BuildConfiguration) --output $(Build.ArtifactStagingDirectory)\${{ parameters.BuildTaskFramework }} --no-restore'
    testRunTitle: UnitTests_${{ parameters.BuildTaskFramework }}
